<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>User Dashboard</title>
  <link rel="stylesheet" href="/Dashboard/style.css">
</head>
<body>

<!-- PROTEKSI LOGIN -->
<script>
  if (localStorage.getItem("isLoggedIn") !== "true") {
    window.location.href = "/Auth/index.html";
  }
</script>

<header style="display:flex;justify-content:space-between;align-items:center">
  <h2>Modul Saya</h2>
  <div>
    <a href="/Dashboard/index.html" class="module-btn" style="margin-right:12px">
      Beranda
    </a>
    <a href="#" id="logoutBtn" class="module-btn">
      Logout
    </a>
  </div>
</header>

<section class="container">
  <div id="myModules" class="modules"></div>
</section>

<script>
  const container = document.getElementById("myModules");
  let modules = JSON.parse(localStorage.getItem("myModules")) || [];

  // JIKA BELUM ADA MODUL
  if (modules.length === 0) {
    container.innerHTML = `
      <p class="hero-desc secondary">
        Kamu belum membeli modul apa pun.
      </p>
      <a href="/Dashboard/index.html" class="module-btn">
        Kembali ke Beranda
      </a>
    `;
  } 
  // JIKA ADA MODUL
  else {

    if (modules.includes("dasar")) {
      container.innerHTML += createModuleCard(
        "dasar",
        "Dasar Pemrograman"
      );
    }

    if (modules.includes("web")) {
      container.innerHTML += createModuleCard(
        "web",
        "Web Development Dasar"
      );
    }

    if (modules.includes("database")) {
      container.innerHTML += createModuleCard(
        "database",
        "Database & SQL"
      );
    }
  }

  // TEMPLATE MODUL
  function createModuleCard(id, title) {
    return `
      <div class="module">
        <h3>${title}</h3>

        <div style="display:flex;gap:12px;margin-top:16px">
          <a href="/Learning/learning.html" class="module-btn">
            Masuk Learning
          </a>

          <button class="module-btn"
            style="background:#ef4444;color:white"
            onclick="removeModule('${id}')">
            Hapus Modul
          </button>
        </div>
      </div>
    `;
  }

  // HAPUS MODUL
  function removeModule(moduleId) {
    if (!confirm("Yakin ingin menghapus modul ini?")) return;

    modules = modules.filter(m => m !== moduleId);
    localStorage.setItem("myModules", JSON.stringify(modules));

    location.reload();
  }

  // LOGOUT
  document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("isLoggedIn");
    window.location.href = "/Dashboard/index.html";
  });
</script>

</body>
</html>
